<tool id="segment_general" name="Segment General" version="0.1">

<description>Finds objects in an image.</description>

<command interpreter="python">
segment_general.py $input_dict $input_image_path $output_results_path $qc_path $outfile 
#if str($min_feature_size) !='': 
   --min_feature $min_feature_size
#end if
#if str($max_feature_size) !='': 
   --max_feature $max_feature_size
#end if
#if str($intensity_threshold) !='': 
   --threshold_percent $intensity_threshold
#end if
#if str($eccentricity) !='': 
   --eccentricity $eccentricity
#end if
</command>

<inputs>
<param name="input_dict" type="data" format="data" label="Local variables dictionary (output from 'Crop Images')."/>
<param name="input_image_path" type="text" format="text" value="/media/robodata/your_folders" size="70" label="Enter path to images that need to be segmented. Example: AlignedImages" help="Note that RoboData/your_folders = /media/robodata/your_folders"/>
<param name="output_results_path" type="text" format="text" value="/media/robodata/your_folders" size="70" label="Enter path to cell masks output destination. Example: CellMasks" help="Note that RoboData/your_folders = /media/robodata/your_folders"/>
<param name="qc_path" type="text" format="text" value="/media/robodata/your_folders" size="70" label="Enter path to output quality control images. Example: QualityControl" help="Note that RoboData/your_folders = /media/robodata/your_folders"/>
<param name="min_feature_size" type="text" format="text" label="Minimum feature (cell) area to capture. Ex. 50" value="50" optional="true"/>
<param name="max_feature_size" type="text" format="text" label="Maximum feature (cell) area to capture. Ex. 2500." value="2500" optional="true" help="Adjust minimum and maximum area of features you would like to analyze. If you find a unique min and max area that works well for your dataset, note the size relative to image dimensions (image area), to recalculate easily for different microscopes."/>
<param name="eccentricity" type="text" format="text" label="Use value between zero and one to set lowerbound to eccentricity." value="0.1" optional="true" help="A perfect circle has eccentricity of zero."/>
<param name="intensity_threshold" type="text" format="text" label="Percent of intensity to exclude as background. Ex. 0.1 (10%)." value="0.1" optional="true" help="Many datasets work well setting a threshold of 10% (10% of maximum intensity is treated as background). If your dataset is not returning enough cells, you can choose a lower threshold (5% or 2% even). Lower threshold values will require substantially more time to process the data, becaue more features must be analyzed and stored. You can similarly increase the threshold to collect fewer features ('cells') and speed up this analysis step."/>
</inputs>

<outputs>
<data name="outfile" type="text" format="data" label="Segment General"/>
</outputs>

<help>
Finds all objects in an image and keeps the ones that meet criteria (size, ellipticity, threshold).
</help>

</tool>