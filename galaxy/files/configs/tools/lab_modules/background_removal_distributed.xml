<tool id="correct_bg_distributed" name="Correct Background Distributed">
<description>Divide Median Values Distributed</description>

<command interpreter="python">
background_removal_distributed.py $infile $input_image_path $output_results_path $qc_path $background_removal_type $outfile 
</command>

<inputs>
<param name="infile" type="data" format="data" label="Local variables dictionary (output from 'Create Folders')."/>
<param name="input_image_path" type="text" format="text" value="/media/robodata/your_folders" size="70" label="Enter path to raw data." help="Note that RoboData/your_folders = /media/robodata/your_folders"/>
<param name="output_results_path" type="text" format="text" value="/media/robodata/your_folders" size="70" label="Enter path to output destination. Example: BackgroundCorrected" help="Note that RoboData/your_folders = /media/robodata/your_folders"/>
<param name="qc_path" type="text" format="text" value="/media/robodata/your_folders" size="70" label="Enter path to output background quality control images. Example: QualityControl" help="Note that RoboData/your_folders = /media/robodata/your_folders"/>
<param name="background_removal_type" type="select" label="Select removal type" help="Division tends to work better visually for montage. Choose subtraction for quantitavie pixel analysis downstream. The generated background image is a median image of all panels in the well. When negative values arise in subtraction, they are set to zero.">
            <option value="division" selected="true"  >Division</option>
            <option value="subtraction"               >Subtraction</option>
</param>
</inputs>

<outputs>
<data name="outfile" type="data" format="data" label="Background Correction Distributed Result"/>
</outputs>

<help>
Calculates a median value from all panels belonging to a montaged image.
Creates a median-valued image.
Subtracts median image from each image to be corrected.
Divides by median image. Resets values to 16-bit.
If microscope background image is given, will use it to subtract from signal.
</help>
</tool>