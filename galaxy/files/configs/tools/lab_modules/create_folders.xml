<tool id="create_folders" name="Create folders and collect file info" version="0.1">

<description>Generates output folder hierarchy.</description>

<command interpreter="python">
create_folders.py $input_image_path $output_results_path $dir_structure $robo_num $imaging_mode $morphology_channel $hnum $vnum $px_overlap $outfile

#if str($these_wells_only) !='': 
   --chosen_wells '$these_wells_only'
#end if
#if str($these_times_only) !='': 
   --chosen_timepoints '$these_times_only'
#end if
</command>

<inputs>
<param name="input_image_path" type="text" format="text" value="/finkbeiner/imaging/smb-robodata/your_folders" size="70" label="Enter path to raw data." help="Note that RoboData/your_folders = /finkbeiner/imaging/smb-robodata/your_folders"/>
<param name="output_results_path" type="text" format="text" value="/finkbeiner/imaging/smb-robodata/your_folders" size="70" label="Enter path to output destination." help="Note that RoboData/your_folders = /finkbeiner/imaging/smb-robodata/your_folders"/>
<param name="dir_structure" type="select" label="Select directory stucture" help="Choose which file structure to use: 1. Images are saved under separeate corresponding Well sub directories; or 2. All images are saved directly under the specified directory.">
            <option value="sub_dir" selected="true"  >Well Subdirectories</option>
            <option value="root_dir"	    		 >Root</option>           
</param>
<param name="robo_num" type="select" label="Select microscope"
       help="Select Robo used for imaging. This information is used to collect the channel, well, time point, etc, from the file name. To select the correct Robo option, choose which one of these naming convention best matches your file names. For IXM please use Robo 0.
Robo3:PIDdate_ExptName_Timepoint_Hours_Well_MontageNumber_Channel.tif
Robo4epi:PIDdate_ExptName_Timepoint_Hours_Well_MontageNumber_Channel_FilterDet_Camera.tif
Robo4confocal:PIDdate_ExptName_Timepoint_Hours_Well_MontageNumber_FilterDet1_FilterDet2_FilterDet3_Channel_DepthIndex_DepthIncrement_Camera.tif
Robo0:PIDdate_ExptName_Timepoint_Hours-BurstIndex_Well_MontageNumber_Channel_TimeIncrement_DepthIndex_DepthIncrement.tif">
            <option value="3" selected="true"  >Robo3</option>
            <option value="4"	    		   >Robo4</option>
            <option value="0"	    		   >Robo0</option>
</param>
<param name="morphology_channel" type="text" format="text" label="Enter morphology channel identifier. This should match the characters in filename." help="Ex. RFP, FITC, Green, 607"/>
<param name="imaging_mode" type="select" label="Select imaging modality." help="You only need to change this if you are using old Robo4 naming scheme. If you are using the Robo0 option above, this parameter is not used.">
            <option value="epi" selected="true">Epi fluorescence</option>
            <option value="confocal"	    		   >Confocal</option>
</param>
<param name="hnum" type="integer" value="" size="10" label="Enter montage image rows." help="Ex. 4"/>
<param name="vnum" type="integer" value="" size="10" label="Enter montage image columns." help="Ex. 4"/>
<param name="px_overlap" type="integer" value="30" size="10" label="Enter image overlap in pixels." help="Ex. 30"/>
<param name="these_wells_only" type="text" format="text" value="" size="70" label="Optional: Enter wells you would like analyzed, separated by commas. Duplicates will be removed." help="Ex. A1,A8,A8,A10,H11,H1 or A1-D8" optional="true"/>
<param name="these_times_only" type="text" format="text" value="" size="70" label="Optional: Enter timepoints you would like analyzed, separated by commas. Duplicates will be removed." help="Ex. T3,T4,T5 or T1-T6" optional="true"/>
</inputs>

<outputs>
<data name="outfile" type="data" format="data" label="Create Folders Results"/>
</outputs>

<help>
Takes input directory - where raw data is stored on the server.
Takes output directory - where the output will be stored.
Takes experiment name - a folder will be generated with the name of the experiment in the output directory. All of the results will be in this folder.
Takes morphology channel (as defined in filename).
Takes imaging path (epi or confocal).
Takes horizontal and vertical dimensions of panels to be montaged.
Takes overlap between images that should be used in stitching.
</help>

</tool>