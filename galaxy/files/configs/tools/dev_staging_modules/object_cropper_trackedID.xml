<tool id="object_cropper" name="Object Cropper" version="0.01">

<description>Makes crops of single objects for CNN training/testing.</description>

<command interpreter="python">
object_cropper_trackedID.py $input_var_dict $channel $crop_dimension $scale_factor $outfile

#if $cell_data_path != '':
   --cell_data_path '$cell_data_path'
#end if
#if $images_input != '':
   --images_input '$images_input'
#end if
#if $object_crops_output != '':
   --object_crops_output '$object_crops_output'
#end if
</command>

<inputs>
<param name="input_var_dict" type="data" format="data" label="Local variables dictionary (e.g. output from 'Extract Cell Info')"/>

<param name="channel" type="text" format="text" size="70" label="Enter channel of images to be cropped."
help="This should match the characters in filename, e.g. FITC, RFP, GFP16, RFP16."/>

<param name="crop_dimension" type="integer" format="text" value="300" size="20" label="Enter size of square crop in pixels."
help="E.g. enter 300 for 300x300 crops"/>

<param name="scale_factor" type="float" format="text" value="1" size="20" label="Enter scaling factor."
help="Scales the input image before cropping. No scaling = 1; 10X sCMOS to 20X EMCCD = 0.992; 20X sCMOS to 20X EMCCD = 0.496"/>

<param name="cell_data_path" type="text" format="text" value="" size="70" label="Optional: Enter path to cell_data.csv"
help="Leave blank to get from Galaxy output folder, or enter path to cell_data.csv, e.g. /finkbeiner/imaging/smb-robodata/your_folders/OverlaysTablesResults/cell_data.csv" optional='true'/>

<param name="images_input" type="text" format="text" value="" size="70" label="Optional: Enter path to images that need to be cropped (e.g. AlignedImages)"
help="Leave blank to get from AlignedImages folder in Galaxy output folder, or enter path to images to be cropped, e.g. /finkbeiner/imaging/smb-robodata/your_folders/AlignedImages" optional='true'/>

<param name="object_crops_output" type="text" format="text" value="" size="70" label="Optional: Output destination"
help="Leave blank to save to ObjectCrops folder in Galaxy output folder, or enter path to where the cropped images will be saved, e.g. /finkbeiner/imaging/smb-robodata/your_folders/ObjectCrops" optional='true'/>
</inputs>

<outputs>
<data name="outfile" type="data" format="data" label="Object Cropper"/>
</outputs>

<help>
Crops images to be centered around single objects, e.g. for use in training and testing a CNN. Note that in any instance of duplicate object IDs, only the object with the largest segmentation area is cropped.
</help>

</tool>