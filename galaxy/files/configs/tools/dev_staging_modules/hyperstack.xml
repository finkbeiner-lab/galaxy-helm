<tool id="hyperstack" name="Hyperstack" version="0.01">

<description>Makes ImageJ-readable hyperstacks.</description>

<command>
source /finkbeiner/imaging/home/fbgalaxy/.virtualenvs/tifffile14/bin/activate; python /finkbeiner/imaging/home/galaxy/tools/dev_staging_modules/hyperstack.py $input_var_dict $channels $colors $scaling_factor $outfile

#if $norm_intensities != '':
   --norm_intensities '$norm_intensities'
#end if
#if $images_path != '':
   --images_path '$images_path'
#end if
#if $overlays_path != '':
   --overlays_path '$overlays_path'
#end if
#if $output_path != '':
   --output_path '$output_path'
#end if
</command>

<inputs>
<param name="input_var_dict" type="data" format="data" label="Local variables dictionary (e.g. output from 'Overlay Cell Tracks')"/>

<param name="channels" type="text" format="text" size="70" label="Comma-separated list of channel tokens to be included, e.g. 'DAPI,FITC,RFP,overlay'" help="List of tokens should be in the desired order and be free of whitespace. Tokens should be a unique match to characters from the channel token (e.g. FITC, RFP, GFP16, RFP16), or enter 'overlay' to make this channel the overlay (case-insensitive)."/>

<param name="colors" type="text" format="text" size="70" label="Comma-separated list of pseudocolors, in order corresponding to the channels entered above, e.g. 'blue,green,red,gray'" help="List of colors should be free of whitespace. The determines how the channels will be pseudocolored when opened in ImageJ. Available color options: green, red, blue, gray (case-insensitive)." optional="true"/>

<param name="norm_intensities" type="text" format="text" size="70" value="0" label="Comma-separated list of pixel intensities for normalization, e.g. 1200,250,0,0"
help="Leave blank for no normalization. Enter '0' to normalize to the calculated maximum dataset pixel intensity. Either of these two approaches is reasonable if you plan to quantitate or compare pixel intensities. To improve display for other applications, enter an intensity value that all images will be normalized to. Note that any value less than the max pixel intensity will saturate pixels, which can be fine for display but should not be used if you're doing intensity quantification."/>

<param name="scaling_factor" type="float" format="text" value="1" size="20" max="1" label="Enter scaling factor for downscaling."
help="Downscales image size to reduce file size. Leave as '1' for no scaling. E.g. '0.5' will reduce image size to 50% of the original size. Downscaling images can significantly reduce the file size, but should only be used if stacks will be used for display (e.g. presentations, manual curation). Downscaling is not recommended if stacks will be used for image quantification."/>

<param name="images_path" type="text" format="text" value="" size="70" label="Optional: Enter path to images (e.g. AlignedImages)."
help="Leave blank to get from AlignedImages folder in Galaxy output folder, or enter path to images to be stacked, e.g. /finkbeiner/imaging/smb-robodata/your_folders/AlignedImages" optional='true'/>

<param name="overlays_path" type="text" format="text" value="" size="70" label="Optional: Enter path to overlay images (e.g. OverlaysTablesResults)."
help="Leave blank to get from OverlaysTablesResults folder in Galaxy output folder, or enter path to overlay images to be stacked, e.g. /finkbeiner/imaging/smb-robodata/your_folders/OverlaysTablesResults" optional='true'/>

<param name="output_path" type="text" format="text" value="" size="70" label="Optional: Enter output path."
help="Leave blank to save to Hyperstacks folder in Galaxy output folder, or enter path to where the stacks should be saved, e.g. /finkbeiner/imaging/smb-robodata/your_folders/Hyperstacks. This folder will be created if it doesn't already exist." optional='true'/>
</inputs>

<outputs>
<data name="outfile" type="data" format="data" label="Hyperstack"/>
</outputs>

<help>
Generates ImageJ-readable hyperstacks. Currently supports up to 3 channels and any number of timepoints, but not multiple z-slices.
</help>

</tool>